# å’ä¸­ç›¸å…³æ€§è‚ºç‚é¢„æµ‹ç³»ç»Ÿ
[English](README.md) | [ç®€ä½“ä¸­æ–‡](README_CN.md)
## é¡¹ç›®æ¦‚è¿°

æœ¬ç³»ç»Ÿæ˜¯ä¸€ä¸ªåŸºäºæ·±åº¦å­¦ä¹ çš„æ™ºèƒ½è¾…åŠ©è¯Šæ–­ç³»ç»Ÿï¼Œç”¨äºé¢„æµ‹å’ä¸­æ‚£è€…å‘ç”Ÿç›¸å…³æ€§è‚ºç‚çš„é£é™©ã€‚ç³»ç»Ÿæ”¯æŒç¼ºè¡€æ€§å’ä¸­å’Œå‡ºè¡€æ€§å’ä¸­ä¸¤ç§ç±»å‹çš„é¢„æµ‹ä»»åŠ¡ï¼Œé€šè¿‡æ•´åˆç—…å†æ–‡æœ¬å’Œä¸´åºŠæŒ‡æ ‡ï¼Œä¸ºåŒ»ç”Ÿæä¾›è¾…åŠ©å†³ç­–æ”¯æŒã€‚
![](https://github.com/user-attachments/assets/465adf14-6cb9-41e4-b56b-776c077f2e25)

## åœ¨çº¿æ¼”ç¤º
[ğŸ¯ç”¨æˆ·æŒ‡å—](docs/help_EN.md)

è®¿é—®åœ¨çº¿æ¼”ç¤ºï¼š [âš¡demo](http://www.badged-lend.com)

![sapå‰ç«¯ä¸­æ–‡](https://github.com/user-attachments/assets/ece96a31-5566-4036-a123-c5221ba51214)

## ç³»ç»Ÿæ¶æ„

### æ¨¡å‹ç»„æˆ

1. æ–‡æœ¬é¢„æµ‹æ¨¡å‹

   - ç¼ºè¡€æ€§å’ä¸­æ–‡æœ¬æ¨¡å‹ (ischemic_text_model.py)
     - åŸºäº MacBERT-CNN æ¶æ„
     - å¤„ç†ä¸­æ–‡ç—…å†æ–‡æœ¬
     - è¾“å‡ºé£é™©æ¦‚ç‡å’Œæ–‡æœ¬é‡è¦æ€§åˆ†æ
   - å‡ºè¡€æ€§å’ä¸­æ–‡æœ¬æ¨¡å‹ (hemorrhagic_text_model.py)
     - ç›¸åŒçš„æ¨¡å‹æ¶æ„
     - é’ˆå¯¹å‡ºè¡€æ€§å’ä¸­ç‰¹ç‚¹ä¼˜åŒ–
     - æä¾›æ–‡æœ¬åˆ†æå¯è§†åŒ–

2. ç»“æ„åŒ–é¢„æµ‹æ¨¡å‹

   - ç¼ºè¡€æ€§å’ä¸­ç»“æ„åŒ–æ¨¡å‹ (ischemic_structured_model.py)
     - åŸºäºè½¯æŠ•ç¥¨é›†æˆå­¦ä¹ 
     - å¤„ç† 6 ä¸ªå…³é”®ä¸´åºŠæŒ‡æ ‡
     - é˜ˆå€¼ä¸º 0.2 çš„äºŒåˆ†ç±»é¢„æµ‹
   - å‡ºè¡€æ€§å’ä¸­ç»“æ„åŒ–æ¨¡å‹ (hemorrhagic_structured_model.py)
     - åŒæ ·åŸºäºé›†æˆå­¦ä¹ 
     - å¤„ç† 7 ä¸ªä¸´åºŠæŒ‡æ ‡
     - é˜ˆå€¼ä¸º 0.3 çš„äºŒåˆ†ç±»é¢„æµ‹

3. ç»„åˆé¢„æµ‹æ¨¡å‹
   - ç¼ºè¡€æ€§å’ä¸­ç»„åˆæ¨¡å‹ (ischemic_combined_model.py)
     - èåˆæ–‡æœ¬å’Œç»“æ„åŒ–ç‰¹å¾
     - æ–‡æœ¬é¢„æµ‹æ¦‚ç‡ä½œä¸ºé¢å¤–ç‰¹å¾
     - SHAP å€¼è§£é‡Šé¢„æµ‹ç»“æœ
   - å‡ºè¡€æ€§å’ä¸­ç»„åˆæ¨¡å‹ (hemorrhagic_combined_model.py)
     - ç±»ä¼¼çš„èåˆç­–ç•¥
     - é’ˆå¯¹æ€§çš„ç‰¹å¾ç»„åˆ
     - å¯è§†åŒ–ç‰¹å¾é‡è¦æ€§

### ç‰¹å¾è¯´æ˜

1. ç¼ºè¡€æ€§å’ä¸­ç‰¹å¾

   - åŸºç¡€ä¿¡æ¯
     - å¹´é¾„ï¼šè¿ç»­å€¼
     - æŠ¢æ•‘æ¬¡æ•°ï¼šæ•´æ•°å€¼
   - ä¸´åºŠè¡¨ç°
     - åå’½å›°éš¾ï¼šæ˜¯/å¦
     - å‘¼å¸æœºç›¸å…³æ€§è‚ºç‚ï¼šæ˜¯/å¦
     - è¤¥ç–®ï¼šæ˜¯/å¦
     - è‚ºéƒ¨ç–¾ç—…ï¼šæ˜¯/å¦

2. å‡ºè¡€æ€§å’ä¸­ç‰¹å¾
   - åŸºç¡€ç—‡çŠ¶
     - åå’½å›°éš¾ï¼šæ˜¯/å¦
     - å‘¼å¸æœºç›¸å…³æ€§è‚ºç‚ï¼šæ˜¯/å¦
     - è¤¥ç–®ï¼šæ˜¯/å¦
   - ç‰¹æ®ŠæŒ‡æ ‡
     - è„‘ç§¯æ°´ï¼šæ˜¯/å¦
     - è„‘ç–ï¼šæ˜¯/å¦
     - ç™½ç»†èƒå¢å¤šï¼šæ˜¯/å¦
     - æ¶ˆåŒ–é“å‡ºè¡€ï¼šæ˜¯/å¦

### é¢„æµ‹é€»è¾‘

1. å•ä¸€æ¨¡å¼é¢„æµ‹

   - ä»…æ–‡æœ¬è¾“å…¥
     - ä½¿ç”¨ BERT æå–æ–‡æœ¬ç‰¹å¾
     - CNN è¿›è¡Œç‰¹å¾èåˆ
     - è¾“å‡ºé£é™©æ¦‚ç‡å’Œé‡è¦æ–‡æœ¬æ ‡æ³¨
   - ä»…æŒ‡æ ‡è¾“å…¥
     - æ ‡å‡†åŒ–ä¸´åºŠæŒ‡æ ‡
     - é›†æˆæ¨¡å‹é¢„æµ‹
     - SHAP å€¼åˆ†æç‰¹å¾è´¡çŒ®

2. ç»„åˆæ¨¡å¼é¢„æµ‹
   - æ–‡æœ¬å¤„ç†æµç¨‹
     - BERT-CNN æå–æ–‡æœ¬ç‰¹å¾
     - è·å–æ–‡æœ¬é¢„æµ‹æ¦‚ç‡
   - ç‰¹å¾èåˆ
     - æ–‡æœ¬é¢„æµ‹å€¼ä½œä¸ºæ–°ç‰¹å¾
     - ä¸ä¸´åºŠæŒ‡æ ‡ç»„åˆ
   - æœ€ç»ˆé¢„æµ‹
     - é›†æˆæ¨¡å‹ç»¼åˆé¢„æµ‹
     - ç”Ÿæˆ SHAP è§£é‡Šå›¾
     - è¾“å‡ºé£é™©è¯„ä¼°ç»“æœ

### è¾“å‡ºç»“æœ

1. é£é™©é¢„æµ‹

   - ç¼ºè¡€æ€§å’ä¸­
     - é«˜é£é™©ï¼šæ¦‚ç‡ > 20%
     - ä½é£é™©ï¼šæ¦‚ç‡ â‰¤ 20%
   - å‡ºè¡€æ€§å’ä¸­
     - é«˜é£é™©ï¼šæ¦‚ç‡ > 30%
     - ä½é£é™©ï¼šæ¦‚ç‡ â‰¤ 30%

2. æ–‡æœ¬åˆ†æ

   - é‡è¦æ€§ç­‰çº§
     - æé«˜ç›¸å…³ï¼šæ·±çº¢è‰²æ ‡æ³¨
     - é«˜åº¦ç›¸å…³ï¼šçº¢è‰²æ ‡æ³¨
     - ä¸­åº¦ç›¸å…³ï¼šé»„è‰²æ ‡æ³¨
     - è½»åº¦ç›¸å…³ï¼šç°è‰²æ ‡æ³¨
   - äº¤äº’åŠŸèƒ½
     - æ‚¬åœæ˜¾ç¤ºé‡è¦åº¦å€¼

3. ç‰¹å¾é‡è¦æ€§
   - SHAP å€¼åˆ†æ
     - çº¢è‰²ï¼šå¢åŠ é£é™©çš„å› ç´ 
     - è“è‰²ï¼šé™ä½é£é™©çš„å› ç´ 
   - å¯è§†åŒ–å±•ç¤º
     - ç€‘å¸ƒå›¾å±•ç¤ºè´¡çŒ®åº¦
     - æ ‡æ³¨å…·ä½“å½±å“å€¼

## æŠ€æœ¯å®ç°

### å‰ç«¯ç•Œé¢

- Gradio æ¡†æ¶
  - å“åº”å¼å¸ƒå±€
  - æ·±è‰²æ¨¡å¼æ”¯æŒ
  - è‡ªå®šä¹‰ CSS æ ·å¼
  - äº¤äº’å¼ç»„ä»¶
  - ä¸­è‹±æ–‡åŒè¯­æ”¯æŒ

### åç«¯æŠ€æœ¯

- æ·±åº¦å­¦ä¹ æ¡†æ¶
  - Python 3.8+
  - PyTorch 1.8+
  - Transformers 4.0+
- æœºå™¨å­¦ä¹ å·¥å…·
  - Scikit-learn
  - SHAP 0.40+
- å·¥å…·åº“
  - Numpy
  - Pandas
  - Matplotlib

### ç³»ç»ŸåŠŸèƒ½

- ä»»åŠ¡åˆ‡æ¢
  - ç¼ºè¡€æ€§/å‡ºè¡€æ€§å’ä¸­é€‰æ‹©
  - ç•Œé¢åŠ¨æ€æ›´æ–°
- æ•°æ®è¾“å…¥
  - æ–‡æœ¬è¾“å…¥æ¡†
  - ä¸´åºŠæŒ‡æ ‡é€‰æ‹©
  - ç¤ºä¾‹æ•°æ®å¡«å……
- ç»“æœå±•ç¤º
  - é£é™©é¢„æµ‹ç»“æœ
  - æ–‡æœ¬åˆ†æå¯è§†åŒ–
  - SHAP å€¼è§£é‡Šå›¾

## éƒ¨ç½²è¯´æ˜

### ç¯å¢ƒé…ç½®

### ç¯å¢ƒè¦æ±‚

- Python 3.8+
- CUDA 11.0+ (GPUç‰ˆæœ¬)
- 4GB+ RAM

### å®‰è£…æ­¥éª¤

1. å…‹éš†ä»“åº“

```bash
git clone https://github.com/your-username/badged-lendcare.git
cd badged-lendcare
```

2. åˆ›å»ºå¹¶æ¿€æ´»condaç¯å¢ƒ

```bash
conda create -n SAP python=3.8
conda activate SAP
```

3. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

4. ä¸‹è½½æ¨¡å‹æ–‡ä»¶

é€‰é¡¹ 1ï¼šè‡ªåŠ¨ä¸‹è½½
```bash
# å®‰è£… huggingface_hub
pip install huggingface_hub

# è¿è¡Œä¸‹è½½è„šæœ¬
python scripts/download_models.py
```

é€‰é¡¹ 2ï¼šæ‰‹åŠ¨ä¸‹è½½
ä»ä»¥ä¸‹åœ°å€ä¸‹è½½æ¨¡å‹æ–‡ä»¶ï¼š
- HuggingFace ä»“åº“ï¼š1.[donghao1234/badged-lend](https://huggingface.co/donghao1234/badged-lend)
2.[hfl/chinese-macbert-base](https://huggingface.co/hfl/chinese-macbert-base)

æ¨¡å‹æ–‡ä»¶ç»“æ„ï¼š
```
models/
â”œâ”€â”€ ischemic/
â”‚   â”œâ”€â”€ text/
â”‚   â”‚   â””â”€â”€ ais_baseline_macbertnewend2cnn_3_1time_epoch3.pth
â”‚   â”œâ”€â”€ structured/
â”‚   â”‚   â””â”€â”€ ais_SoftVoting_6_mice1.pkl
â”‚   â””â”€â”€ combined/
â”‚       â””â”€â”€ ais_SoftVoting_7_mice1.pkl
â”œâ”€â”€ hemorrhagic/
â”‚   â”œâ”€â”€ text/
â”‚   â”‚   â””â”€â”€ ich_baseline_macbertnewend1cnn_1time_epoch3.pth
â”‚   â”œâ”€â”€ structured/
â”‚   â”‚   â””â”€â”€ ich_SoftVoting_7_mice1.pkl
â”‚   â””â”€â”€ combined/
â”‚       â””â”€â”€ ich_SoftVoting_8_mice1.pkl
â””â”€â”€ macbert/
    â”œâ”€â”€ config.json
    â”œâ”€â”€ pytorch_model.bin
    â”œâ”€â”€ vocab.txt
    â””â”€â”€ tokenizer_config.json
```

5. å¯åŠ¨åº”ç”¨

```bash
python app.py
```

6. è®¿é—®åœ°å€
   - æœ¬åœ°è®¿é—®ï¼šhttp://localhost:8080
   - é»˜è®¤ç«¯å£ï¼š7860

## å¼€å‘å›¢é˜Ÿ

### ç ”ç©¶æœºæ„

ä¸­å›½è¯ç§‘å¤§å­¦ç†å­¦é™¢åŒ»è¯å¤§æ•°æ®ä¸äººå·¥æ™ºèƒ½å®éªŒå®¤

### è”ç³»æ–¹å¼

- ğŸ“§ é‚®ç®±ï¼šliaojun@cpu.edu.cn
- ğŸ›ï¸ åœ°å€ï¼šä¸­å›½è¯ç§‘å¤§å­¦ç†å­¦é™¢
- ğŸ”¬ å®éªŒå®¤ï¼šåŒ»è¯å¤§æ•°æ®ä¸äººå·¥æ™ºèƒ½å®éªŒå®¤
- â° å·¥ä½œæ—¶é—´ï¼šå‘¨ä¸€è‡³å‘¨äº” 9:00-18:00

## è®¸å¯è¯

[Apache 2.0](LICENSE)

## å¤‡æ¡ˆä¿¡æ¯

- [è‹å…¬ç½‘å®‰å¤‡ 32010602011293 å·](https://beian.mps.gov.cn/#/query/webSearch)
- [è‹ ICP å¤‡ 2023023603](https://beian.miit.gov.cn/#/Integrated/index)
